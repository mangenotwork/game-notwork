/**
 * hilojs 2.0.2 for kissy
 * Copyright 2016 alibaba.com
 * Licensed under the MIT License
 */
KISSY.add("hilo/renderer/CanvasRenderer",function(t,e,a,r){var i=e.create({Extends:r,constructor:function(t){i.superclass.constructor.call(this,t),this.context=this.canvas.getContext("2d")},renderType:"canvas",context:null,startDraw:function(t){return!!(t.visible&&t.alpha>0)&&(t===this.stage&&this.context.clearRect(0,0,t.width,t.height),t.blendMode!==this.blendMode&&(this.context.globalCompositeOperation=this.blendMode=t.blendMode),this.context.save(),!0)},draw:function(t){var e=this.context,a=t.width,r=t.height,i=t.background;i&&(e.fillStyle=i,e.fillRect(0,0,a,r));var n=t.drawable,s=n&&n.image;if(s){var l=n.rect,o=l[2],h=l[3],c=l[4],d=l[5];if(!o||!h)return;a||r||(a=t.width=o,r=t.height=h),(c||d)&&e.translate(c-.5*o,d-.5*h),e.drawImage(s,l[0],l[1],o,h,0,0,a,r)}},endDraw:function(t){this.context.restore()},transform:function(t){var e=t.drawable;if(e&&e.domElement)return void a.setElementStyleByView(t);var r=this.context,i=t.scaleX,n=t.scaleY;if(t===this.stage){var s=this.canvas.style,l=t._scaleX,o=t._scaleY,h=!1;(!l&&1!=i||l&&l!=i)&&(t._scaleX=i,s.width=i*t.width+"px",h=!0),(!o&&1!=n||o&&o!=n)&&(t._scaleY=n,s.height=n*t.height+"px",h=!0),h&&t.updateViewport()}else{var c=t.x,d=t.y,v=t.pivotX,f=t.pivotY,g=t.rotation%360,u=t.transform,p=t.mask;p&&(p._render(this),r.clip());var x=t.align;if(x){var w=t.getAlignPosition();c=w.x,d=w.y}u?r.transform(u.a,u.b,u.c,u.d,u.tx,u.ty):(0==c&&0==d||r.translate(c,d),0!=g&&r.rotate(g*Math.PI/180),1==i&&1==n||r.scale(i,n),0==v&&0==f||r.translate(-v,-f))}t.alpha>0&&(r.globalAlpha*=t.alpha)},remove:function(t){var e=t.drawable,a=e&&e.domElement;if(a){var r=a.parentNode;r&&r.removeChild(a)}},clear:function(t,e,a,r){this.context.clearRect(t,e,a,r)},resize:function(t,e){var a=this.canvas,r=this.stage,i=a.style;a.width=t,a.height=e,i.width=r.width*r.scaleX+"px",i.height=r.height*r.scaleY+"px"}});return i},{requires:["hilo/core/Class","hilo/core/Hilo","hilo/renderer/Renderer"]});